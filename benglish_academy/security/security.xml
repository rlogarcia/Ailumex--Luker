<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">

        <!-- Grupo: Usuario - Visualización básica -->
        <record id="group_academic_user" model="res.groups">
            <field name="name">Usuario Académico</field>
            <field name="category_id" eval="False" />
            <field name="implied_ids" eval="[(5, 0, 0)]" />
            <field name="comment">Acceso de solo lectura a la información académica</field>
        </record>

        <!-- Grupo: Docente - Consulta de programación -->
        <record id="group_academic_teacher" model="res.groups">
            <field name="name">Docente</field>
            <field name="category_id" eval="False" />
            <field name="implied_ids" eval="[(5, 0, 0)]" />
            <field name="comment">Acceso para docentes: visualización de horarios, grupos y
                estudiantes</field>
        </record>

        <!-- Grupo: Asistente Académico - Gestión operativa -->
        <record id="group_academic_assistant" model="res.groups">
            <field name="name">Asistente Académico</field>
            <field name="category_id" eval="False" />
            <field name="implied_ids" eval="[(5, 0, 0)]" />
            <field name="comment">Gestión de matrículas, horarios y operación diaria</field>
        </record>

        <!-- Grupo: Coordinador Académico - Gestión completa -->
        <record id="group_academic_coordinator" model="res.groups">
            <field name="name">Coordinador Académico</field>
            <field name="category_id" eval="False" />
            <field name="implied_ids" eval="[(5, 0, 0)]" />
            <field name="comment">Gestión completa de estructura académica, programación y reportes</field>
        </record>

        <!-- Grupo: Administrador Académico - Configuración -->
        <record id="group_academic_manager" model="res.groups">
            <field name="name">Administrador Académico</field>
            <field name="category_id" eval="False" />
            <field name="implied_ids" eval="[(5, 0, 0)]" />
            <field name="comment">Gestión institucional: sedes, aulas y recursos físicos</field>
        </record>

        <!-- Reglas de acceso por registro (Record Rules) -->

        <!-- Regla: Usuarios pueden ver solo información activa -->
        <record id="academic_program_user_rule" model="ir.rule">
            <field name="name">Usuario: Ver programas activos</field>
            <field name="model_id" ref="model_benglish_program" />
            <field name="domain_force">[('active', '=', True)]</field>
            <field name="groups" eval="[(4, ref('group_academic_user'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="0" />
            <field name="perm_create" eval="0" />
            <field name="perm_unlink" eval="0" />
        </record>

        <!-- Regla: Coordinadores pueden gestionar todo -->
        <record id="academic_program_coordinator_rule" model="ir.rule">
            <field name="name">Coordinador: Gestión completa de programas</field>
            <field name="model_id" ref="model_benglish_program" />
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_academic_coordinator'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="1" />
            <field name="perm_create" eval="1" />
            <field name="perm_unlink" eval="0" />
        </record>

        <!-- Regla: Administradores pueden todo incluyendo eliminar -->
        <record id="academic_program_manager_rule" model="ir.rule">
            <field name="name">Administrador: Control total de programas</field>
            <field name="model_id" ref="model_benglish_program" />
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_academic_manager'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="1" />
            <field name="perm_create" eval="1" />
            <field name="perm_unlink" eval="1" />
        </record>

        <!-- ========================================== -->
        <!-- REGLAS PARA MÓDULO AGENDA ACADÉMICA -->
        <!-- ========================================== -->

        <!-- AGENDA ACADÉMICA -->
        <!-- Docentes: solo lectura de agendas activas -->
        <record id="academic_agenda_teacher_rule" model="ir.rule">
            <field name="name">Docente: Ver agendas activas</field>
            <field name="model_id" ref="model_benglish_academic_agenda" />
            <field name="domain_force">[('state', '=', 'active')]</field>
            <field name="groups" eval="[(4, ref('group_academic_teacher'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="0" />
            <field name="perm_create" eval="0" />
            <field name="perm_unlink" eval="0" />
        </record>

        <!-- Coordinadores: gestión completa de agendas (sin eliminar) -->
        <record id="academic_agenda_coordinator_rule" model="ir.rule">
            <field name="name">Coordinador: Gestión de agendas</field>
            <field name="model_id" ref="model_benglish_academic_agenda" />
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_academic_coordinator'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="1" />
            <field name="perm_create" eval="1" />
            <field name="perm_unlink" eval="0" />
        </record>

        <!-- Managers: control total -->
        <record id="academic_agenda_manager_rule" model="ir.rule">
            <field name="name">Manager: Control total de agendas</field>
            <field name="model_id" ref="model_benglish_academic_agenda" />
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_academic_manager'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="1" />
            <field name="perm_create" eval="1" />
            <field name="perm_unlink" eval="1" />
        </record>

        <!-- SESIONES ACADÉMICAS -->
        <!-- Docentes: ver sesiones publicadas donde están asignados -->
        <record id="academic_session_teacher_rule" model="ir.rule">
            <field name="name">Docente: Ver sus sesiones publicadas</field>
            <field name="model_id" ref="model_benglish_academic_session" />
            <field name="domain_force">['|', ('teacher_id.id', '=', user.id),
                ('teacher_id.user_id.id', '=', user.id), ('state', 'in', ['published', 'started',
                'done'])]</field>
            <field name="groups" eval="[(4, ref('group_academic_teacher'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="0" />
            <field name="perm_create" eval="0" />
            <field name="perm_unlink" eval="0" />
        </record>

        <!-- Coordinadores: gestión completa de sesiones (sin eliminar) -->
        <record id="academic_session_coordinator_rule" model="ir.rule">
            <field name="name">Coordinador: Gestión de sesiones</field>
            <field name="model_id" ref="model_benglish_academic_session" />
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_academic_coordinator'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="1" />
            <field name="perm_create" eval="1" />
            <field name="perm_unlink" eval="0" />
        </record>

        <!-- Managers: control total -->
        <record id="academic_session_manager_rule" model="ir.rule">
            <field name="name">Manager: Control total de sesiones</field>
            <field name="model_id" ref="model_benglish_academic_session" />
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_academic_manager'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="1" />
            <field name="perm_create" eval="1" />
            <field name="perm_unlink" eval="1" />
        </record>

        <!-- INSCRIPCIONES DE SESIONES -->
        <!-- Estudiantes: ver solo sus propias inscripciones -->
        <record id="session_enrollment_student_rule" model="ir.rule">
            <field name="name">Estudiante: Ver sus inscripciones</field>
            <field name="model_id" ref="model_benglish_session_enrollment" />
            <field name="domain_force">[('student_id.user_id.id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_academic_user'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="0" />
            <field name="perm_create" eval="0" />
            <field name="perm_unlink" eval="0" />
        </record>

        <!-- Docentes: ver inscripciones de sus sesiones y marcar asistencia -->
        <record id="session_enrollment_teacher_rule" model="ir.rule">
            <field name="name">Docente: Gestionar inscripciones de sus sesiones</field>
            <field name="model_id" ref="model_benglish_session_enrollment" />
            <field name="domain_force">['|', ('session_id.teacher_id.id', '=', user.id),
                ('session_id.teacher_id.user_id.id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_academic_teacher'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="1" />
            <field name="perm_create" eval="0" />
            <field name="perm_unlink" eval="0" />
        </record>

        <!-- Coordinadores: gestión completa (sin eliminar) -->
        <record id="session_enrollment_coordinator_rule" model="ir.rule">
            <field name="name">Coordinador: Gestión de inscripciones</field>
            <field name="model_id" ref="model_benglish_session_enrollment" />
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_academic_coordinator'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="1" />
            <field name="perm_create" eval="1" />
            <field name="perm_unlink" eval="0" />
        </record>

        <!-- Managers: control total -->
        <record id="session_enrollment_manager_rule" model="ir.rule">
            <field name="name">Manager: Control total de inscripciones</field>
            <field name="model_id" ref="model_benglish_session_enrollment" />
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_academic_manager'))]" />
            <field name="perm_read" eval="1" />
            <field name="perm_write" eval="1" />
            <field name="perm_create" eval="1" />
            <field name="perm_unlink" eval="1" />
        </record>

    </data>
</odoo>