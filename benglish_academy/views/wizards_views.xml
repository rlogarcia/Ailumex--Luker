<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- Wizard: Reemplazo de Docente -->
        <record id="view_replace_teacher_wizard_form" model="ir.ui.view">
            <field name="name">benglish.replace.teacher.wizard.form</field>
            <field name="model">benglish.replace.teacher.wizard</field>
            <field name="arch" type="xml">
                <form string="Reemplazar Docente">
                    <group>
                        <field name="session_id" invisible="1" />
                        <field name="session_ids" invisible="1" />
                    </group>

                    <group string="üîÑ Reemplazo de Docente">
                        <group>
                            <field name="original_teacher_id" readonly="1"
                                widget="many2one_avatar_user" string="Docente Actual" />
                            <field name="new_teacher_id" options="{'no_create': True}"
                                widget="many2one_avatar_user" string="Nuevo Docente" />
                        </group>
                        <group>
                            <field name="replacement_scope" widget="radio"
                                string="Alcance del Reemplazo" />
                            <field name="effective_date"
                                invisible="replacement_scope != 'future'"
                                string="Fecha Efectiva" />
                            <field name="sessions_to_replace_count" readonly="1"
                                string="Sesiones a Afectar"
                                class="text-primary fw-bold" />
                        </group>
                    </group>

                    <group string="üìù Motivo y Notas">
                        <field name="replacement_reason" nolabel="1"
                            placeholder="Indique el motivo del reemplazo: licencia m√©dica, vacaciones, emergencia familiar, etc." />
                    </group>

                    <group string="üìÑ Notas Adicionales (Opcional)">
                        <field name="notes" nolabel="1"
                            placeholder="Informaci√≥n complementaria sobre el reemplazo..." />
                    </group>

                    <group string="‚öôÔ∏è Validaciones">
                        <group>
                            <field name="check_conflicts" widget="boolean_toggle"
                                string="Verificar Conflictos de Horario" />
                            <field name="skip_conflicts" widget="boolean_toggle"
                                invisible="not check_conflicts"
                                string="Omitir Sesiones con Conflictos" />
                        </group>
                    </group>

                    <group invisible="not conflict_warning">
                        <field name="conflict_warning" widget="text" readonly="1"
                            class="alert alert-warning" nolabel="1" />
                    </group>

                    <footer>
                        <button name="action_replace" string="Reemplazar Docente"
                            type="object" class="btn-primary" />
                        <button string="Cancelar" class="btn-secondary" special="cancel" />
                    </footer>
                </form>
            </field>
        </record>

        <!-- Wizard: Duplicaci√≥n de Sesiones        -->
        <record id="view_duplicate_sessions_wizard_form" model="ir.ui.view">
            <field name="name">benglish.duplicate.sessions.wizard.form</field>
            <field name="model">benglish.duplicate.sessions.wizard</field>
            <field name="arch" type="xml">
                <form string="Duplicar Sesiones">
                    <group>
                        <group string="üìç Periodo Origen">
                            <field name="source_campus_id" options="{'no_create': True}" />
                            <field name="source_start_date" />
                            <field name="source_end_date" />
                            <field name="source_session_count" readonly="1"
                                string="Sesiones encontradas" />
                        </group>
                        <group string="üéØ Destino">
                            <field name="target_campus_id" options="{'no_create': True}" />
                            <field name="target_start_date" />
                            <field name="date_offset_days" readonly="1"
                                widget="integer" string="Desplazamiento (d√≠as)" />
                        </group>
                    </group>
                    <group string="‚öôÔ∏è Opciones">
                        <group>
                            <field name="copy_published_state" widget="boolean_toggle" />
                            <field name="auto_adjust_teachers" widget="boolean_toggle" />
                        </group>
                        <group>
                            <field name="skip_conflicts" widget="boolean_toggle" />
                        </group>
                    </group>
                    <notebook>
                        <page string="Sesiones a Duplicar" name="sessions">
                            <field name="source_session_ids" nolabel="1">
                                <list>
                                    <field name="start_datetime" />
                                    <field name="subject_id" />
                                    <field name="teacher_id" widget="many2one_avatar_user" />
                                    <field name="campus_id" />
                                    <field name="state" widget="badge" />
                                </list>
                            </field>
                        </page>
                    </notebook>
                    <footer>
                        <button name="action_duplicate" string="Duplicar Sesiones"
                            type="object" class="btn-primary" />
                        <button string="Cancelar" class="btn-secondary" special="cancel" />
                    </footer>
                </form>
            </field>
        </record>

        <record id="action_duplicate_sessions_wizard" model="ir.actions.act_window">
            <field name="name">Duplicar Sesiones</field>
            <field name="res_model">benglish.duplicate.sessions.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>

        <!-- Wizard: Edici√≥n Masiva                 -->
        <record id="view_bulk_edit_sessions_wizard_form" model="ir.ui.view">
            <field name="name">benglish.bulk.edit.sessions.wizard.form</field>
            <field name="model">benglish.bulk.edit.sessions.wizard</field>
            <field name="arch" type="xml">
                <form string="Edici√≥n Masiva de Sesiones">
                    <group>
                        <group>
                            <field name="session_ids" invisible="1" />
                            <field name="session_count" readonly="1" string="Sesiones seleccionadas" />
                            <field name="action_type" widget="radio" />
                        </group>
                        <group>
                            <field name="skip_conflicts" widget="boolean_toggle" />
                            <field name="preview_mode" widget="boolean_toggle" />
                        </group>
                    </group>
                    <group string="‚öôÔ∏è Par√°metros de la Acci√≥n">
                        <group>
                            <field name="new_teacher_id"
                                invisible="action_type != 'change_teacher'"
                                options="{'no_create': True}"
                                widget="many2one_avatar_user"
                                required="action_type == 'change_teacher'" />
                            <field name="new_campus_id"
                                invisible="action_type != 'change_campus'"
                                options="{'no_create': True}"
                                required="action_type == 'change_campus'" />
                            <field name="new_subcampus_id"
                                invisible="action_type != 'change_campus'"
                                options="{'no_create': True}" />
                            <field name="new_delivery_mode"
                                invisible="action_type != 'change_mode'"
                                widget="radio"
                                required="action_type == 'change_mode'" />
                        </group>
                        <group>
                            <field name="time_shift_days"
                                invisible="action_type != 'shift_time'" />
                            <field name="time_shift_hours"
                                invisible="action_type != 'shift_time'" />
                        </group>
                    </group>
                    <group string="üìù Motivo del Reemplazo (T22-HU6)"
                        invisible="action_type != 'change_teacher'">
                        <field name="replacement_reason" nolabel="1"
                            placeholder="Indique el motivo: licencia m√©dica, vacaciones, emergencia, etc."
                            required="action_type == 'change_teacher'" />
                    </group>
                    <footer>
                        <button name="action_apply" string="Aplicar Cambios"
                            type="object" class="btn-primary" />
                        <button string="Cancelar" class="btn-secondary" special="cancel" />
                    </footer>
                </form>
            </field>
        </record>

        <record id="action_bulk_edit_sessions_wizard" model="ir.actions.act_window">
            <field name="name">Edici√≥n Masiva</field>
            <field name="res_model">benglish.bulk.edit.sessions.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="binding_model_id" ref="model_benglish_class_session" />
        </record>

        <!-- Wizard: Generador de Sesiones Masivas             -->
        <record id="view_generate_sessions_wizard_form" model="ir.ui.view">
            <field name="name">benglish.generate.sessions.wizard.form</field>
            <field name="model">benglish.generate.sessions.wizard</field>
            <field name="arch" type="xml">
                <form string="üóìÔ∏è Generar Sesiones de Clase">
                    <!-- Alertas de informaci√≥n -->
                    <div class="alert alert-info" role="alert">
                        <strong><i class="fa fa-magic" /> Generador Autom√°tico de Sesiones</strong>
                        <p class="mb-0">
                            Configure el horario semanal y el periodo para generar autom√°ticamente
                            todas las sesiones del grupo. El sistema detectar√° conflictos de
                            horario.
                        </p>
                    </div>

                    <!-- Alerta de conflictos -->
                    <div class="alert alert-warning" role="alert" invisible="not conflict_warning">
                        <field name="conflict_warning" readonly="1" nolabel="1" />
                    </div>

                    <!-- Informaci√≥n del Grupo -->
                    <group string="üìö Grupo">
                        <group>
                            <field name="group_id" options="{'no_create': True}"
                                placeholder="Seleccione el grupo..." />
                            <field name="group_name" invisible="1" />
                        </group>
                        <group>
                            <field name="campus_id" readonly="1" />
                            <field name="subcampus_id" readonly="1" />
                        </group>
                    </group>

                    <group>
                        <group>
                            <field name="teacher_id" readonly="1" widget="many2one_avatar_user" />
                            <field name="coach_id" readonly="1" />
                        </group>
                        <group>
                            <field name="delivery_mode" readonly="1" widget="badge" />
                        </group>
                    </group>

                    <separator string="üìÖ Periodo" />

                    <group>
                        <group>
                            <field name="date_start" />
                            <field name="date_end" />
                            <field name="weeks_count" readonly="1" string="Semanas" />
                        </group>
                        <group>
                            <field name="session_type" widget="radio" />
                        </group>
                    </group>

                    <separator string="üïê D√≠as y Horario" />

                    <group>
                        <group string="D√≠as de la Semana">
                            <div class="row gx-2">
                                <div class="col-auto d-flex flex-column align-items-center px-2">
                                    <field name="monday" widget="boolean_toggle" nolabel="1" />
                                    <div class="small mt-1">Lunes</div>
                                </div>
                                <div class="col-auto d-flex flex-column align-items-center px-2">
                                    <field name="tuesday" widget="boolean_toggle" nolabel="1" />
                                    <div class="small mt-1">Martes</div>
                                </div>
                                <div class="col-auto d-flex flex-column align-items-center px-2">
                                    <field name="wednesday" widget="boolean_toggle" nolabel="1" />
                                    <div class="small mt-1">Mi√©rcoles</div>
                                </div>
                                <div class="col-auto d-flex flex-column align-items-center px-2">
                                    <field name="thursday" widget="boolean_toggle" nolabel="1" />
                                    <div class="small mt-1">Jueves</div>
                                </div>
                                <div class="col-auto d-flex flex-column align-items-center px-2">
                                    <field name="friday" widget="boolean_toggle" nolabel="1" />
                                    <div class="small mt-1">Viernes</div>
                                </div>
                                <div class="col-auto d-flex flex-column align-items-center px-2">
                                    <field name="saturday" widget="boolean_toggle" nolabel="1" />
                                    <div class="small mt-1">S√°bado</div>
                                </div>
                                <div class="col-auto d-flex flex-column align-items-center px-2">
                                    <field name="sunday" widget="boolean_toggle" nolabel="1" />
                                    <div class="small mt-1">Domingo</div>
                                </div>
                            </div>
                        </group>
                        <group string="Horario de Clase">
                            <field name="time_start" widget="float_time" />
                            <field name="time_end" widget="float_time" />
                            <div class="mt-2">
                                <span class="badge text-bg-primary fs-6">
                                    <i class="fa fa-clock-o" /> 
                                    <field name="time_start_display"
                                        readonly="1" /> - <field name="time_end_display"
                                        readonly="1" />
                                </span>
                            </div>
                        </group>
                    </group>

                    <separator string="‚öôÔ∏è Configuraci√≥n" />

                    <group>
                        <group>
                            <field name="auto_publish" widget="boolean_toggle" />
                            <field name="skip_conflicts" widget="boolean_toggle" />
                        </group>
                        <group>
                            <div class="alert alert-success text-center py-3" role="alert">
                                <h3 class="mb-0">
                                    <i class="fa fa-calendar-check-o" />
                                    <field name="sessions_to_create" readonly="1" class="h3" />
                                    <span>sesiones a crear</span>
                                </h3>
                            </div>
                        </group>
                    </group>

                    <separator string="üìã Vista Previa de Fechas" />

                    <group>
                        <field name="preview_dates" readonly="1" nolabel="1"
                            widget="text" class="o_field_text" />
                    </group>

                    <footer>
                        <button name="action_generate_sessions" string="üöÄ Generar Sesiones"
                            type="object" class="btn-primary" />
                        <button string="Cancelar" class="btn-secondary" special="cancel" />
                    </footer>
                </form>
            </field>
        </record>

        <record id="action_generate_sessions_wizard" model="ir.actions.act_window">
            <field name="name">Generar Sesiones</field>
            <field name="res_model">benglish.generate.sessions.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>

        <!-- Acci√≥n desde grupo -->
        <record id="action_generate_sessions_wizard_from_group" model="ir.actions.act_window">
            <field name="name">Generar Sesiones del Grupo</field>
            <field name="res_model">benglish.generate.sessions.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="context">{'default_group_id': active_id}</field>
        </record>

        <!-- ===================================================================== -->
        <!-- WIZARD: ACTUALIZAR C√ìDIGOS ACAD√âMICOS                                -->
        <!-- ===================================================================== -->

        <!-- Vista del wizard para actualizar c√≥digos acad√©micos -->
        <record id="view_update_academic_codes_form" model="ir.ui.view">
            <field name="name">benglish.update.academic.codes.form</field>
            <field name="model">benglish.update.academic.codes</field>
            <field name="arch" type="xml">
                <form string="Actualizar C√≥digos Acad√©micos">
                    <group>
                        <group>
                            <field name="model_to_update" widget="radio" />
                        </group>
                        <group>
                            <field name="only_invalid_codes" />
                            <field name="preview_mode" />
                        </group>
                    </group>

                    <notebook invisible="not preview_results">
                        <page string="Vista Previa de Cambios">
                            <field name="preview_results" nolabel="1" widget="text" />
                        </page>
                    </notebook>

                    <footer>
                        <button string="Ejecutar" name="action_update_codes" type="object"
                            class="btn-primary" />
                        <button string="Cancelar" class="btn-secondary" special="cancel" />
                    </footer>
                </form>
            </field>
        </record>

        <!-- Acci√≥n del wizard -->
        <record id="action_update_academic_codes" model="ir.actions.act_window">
            <field name="name">Actualizar C√≥digos Acad√©micos</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">benglish.update.academic.codes</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>

        <!-- ===================================================================== -->
        <!-- WIZARD: DUPLICAR AGENDA INTELIGENTEMENTE                             -->
        <!-- ===================================================================== -->

        <!-- Vista Form del Wizard de Duplicaci√≥n de Agenda -->
        <record id="view_duplicate_agenda_wizard_form" model="ir.ui.view">
            <field name="name">benglish.duplicate.agenda.wizard.form</field>
            <field name="model">benglish.duplicate.agenda.wizard</field>
            <field name="arch" type="xml">
                <form string="Duplicar Agenda Acad√©mica">
                    <sheet>
                        <div class="alert alert-info" role="alert">
                            <p>
                                <strong>‚ÑπÔ∏è Duplicaci√≥n de Agenda</strong><br /> Este asistente
                                crear√° una <strong>nueva agenda</strong> con todas sus sesiones.<br /><br />
                                
                                <strong>
                                Caracter√≠sticas:</strong><br /> ‚Ä¢ Las sesiones mantienen el <strong>mismo
                                d√≠a de la semana</strong><br /> ‚Ä¢ Se valida la <strong>
                                disponibilidad</strong> de docentes y aulas<br />
                            </p>
                        </div>

                        <separator string="üìã Agenda Origen" />

                        <group>
                            <group>
                                <field name="source_agenda_id" invisible="1" />
                                <field name="source_code" readonly="1" />
                                <field name="source_campus" readonly="1" />
                                <field name="source_date_start" readonly="1" />
                                <field name="source_date_end" readonly="1" />
                                <field name="source_session_count" readonly="1" />
                            </group>
                            <group>
                                <field name="source_summary" readonly="1" nolabel="1"
                                    widget="text"
                                    class="o_field_text"
                                    style="font-family: monospace; background-color: #f8f9fa; padding: 10px; border: 1px solid #dee2e6;" />
                            </group>
                        </group>

                        <separator string="üìÖ Configuraci√≥n de la nueva agenda" />

                        <group>
                            <group string="Fechas de la nueva agenda">
                                <field name="new_date_start" required="1" />
                                <field name="new_date_end" required="1" />
                                <field name="new_duration_days" readonly="1" />
                            </group>
                            <group string="Previsualizaci√≥n">
                                <field name="estimated_sessions" readonly="1" />
                                <field name="weekdays_distribution" readonly="1" widget="text"
                                    style="font-family: monospace; background-color: #e7f3ff; padding: 5px;" />
                            </group>
                        </group>

                        <separator string="‚öôÔ∏è Opciones de Duplicaci√≥n" />

                        <group>
                            <group string="Gesti√≥n de Conflictos">
                                <field name="skip_conflicts" />
                                <div class="alert alert-warning" role="alert"
                                    invisible="not skip_conflicts">
                                    <p> ‚ö†Ô∏è <strong>Modo: Omitir conflictos</strong><br /> Las
                                        sesiones con docentes o aulas ocupadas se omitir√°n. Al
                                        finalizar, ver√°s un resumen de sesiones omitidas. </p>
                                </div>
                                <div class="alert alert-danger" role="alert"
                                    invisible="skip_conflicts">
                                    <p> üõë <strong>Modo: Detener en conflictos</strong><br /> El
                                        proceso se detendr√° al encontrar el primer conflicto. No se
                                        crear√° ninguna sesi√≥n hasta resolver todos los conflictos. </p>
                                </div>
                            </group>

                            <group string="Otras Opciones">
                                <field name="copy_published_state" />
                                <field name="validate_campus_schedule" />
                            </group>
                        </group>

                    </sheet>
                    <footer>
                        <button name="action_duplicate_agenda"
                            string="‚úÖ Duplicar Agenda"
                            type="object"
                            class="btn-primary" />
                        <button string="Cancelar"
                            class="btn-secondary"
                            special="cancel" />
                    </footer>
                </form>
            </field>
        </record>

        <!-- Acci√≥n para abrir el wizard desde el bot√≥n en la vista form de agenda -->
        <record id="action_duplicate_agenda_wizard" model="ir.actions.act_window">
            <field name="name">Duplicar Agenda</field>
            <field name="res_model">benglish.duplicate.agenda.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="binding_model_id" ref="model_benglish_academic_agenda" />
            <field name="binding_view_types">form</field>
        </record>

        <!-- Wizard: Traslado/Combinacion de Estudiantes -->
        <record id="view_session_transfer_wizard_form" model="ir.ui.view">
            <field name="name">benglish.session.transfer.wizard.form</field>
            <field name="model">benglish.session.transfer.wizard</field>
            <field name="arch" type="xml">
                <form string="Traslado/Combinacion de Estudiantes">
                    <group>
                        <group string="Origen">
                            <field name="source_session_id" readonly="1" />
                            <field name="source_session_code" readonly="1" />
                            <field name="source_subject_id" readonly="1" />
                            <field name="source_date" readonly="1" />
                            <field name="source_time_start_label" readonly="1" />
                            <field name="source_time_end_label" readonly="1" />
                            <field name="source_campus_id" readonly="1" />
                            <field name="source_teacher_id" readonly="1" />
                            <field name="source_enrolled_count" readonly="1" />
                        </group>
                        <group string="Destino">
                            <field name="destination_session_id"
                                options="{'no_create': True}"
                                placeholder="Selecciona la clase destino..." />
                            <separator string="Detalles de la Clase Destino" colspan="2" 
                                invisible="not destination_session_id"/>
                            <field name="destination_session_code" readonly="1" 
                                invisible="not destination_session_id"/>
                            <field name="destination_subject_id" readonly="1" 
                                invisible="not destination_session_id"/>
                            <field name="destination_date" readonly="1" 
                                invisible="not destination_session_id"/>
                            <field name="destination_time_start_label" readonly="1" 
                                invisible="not destination_session_id"/>
                            <field name="destination_time_end_label" readonly="1" 
                                invisible="not destination_session_id"/>
                            <field name="destination_campus_id" readonly="1" 
                                invisible="not destination_session_id"/>
                            <field name="destination_teacher_id" readonly="1" 
                                invisible="not destination_session_id"/>
                            <field name="destination_enrolled_count" readonly="1" 
                                invisible="not destination_session_id"/>
                            <field name="destination_available_spots" readonly="1" 
                                invisible="not destination_session_id"/>
                            <field name="destination_state" widget="badge" readonly="1" 
                                invisible="not destination_session_id"/>
                            <field name="destination_is_published" readonly="1" 
                                invisible="not destination_session_id"/>
                        </group>
                    </group>

                    <group string="Alcance">
                        <field name="transfer_mode" widget="radio" />
                        <field name="student_id"
                            invisible="transfer_mode != 'single'"
                            required="transfer_mode == 'single'"
                            options="{'no_create': True}" />
                        <field name="reason"
                            placeholder="Motivo opcional del traslado..." />
                    </group>

                    <group invisible="not validation_message">
                        <field name="validation_message"
                            nolabel="1"
                            readonly="1"
                            class="alert alert-warning" />
                    </group>

                    <footer>
                        <button name="action_transfer"
                            string="Confirmar traslado"
                            type="object"
                            class="btn-primary"
                            invisible="can_transfer == False"
                            confirm="Confirma el traslado de estudiantes al destino seleccionado." />
                        <button string="Cancelar"
                            class="btn-secondary"
                            special="cancel" />
                    </footer>
                </form>
            </field>
        </record>

        <record id="action_session_transfer_wizard" model="ir.actions.act_window">
            <field name="name">Trasladar Estudiantes</field>
            <field name="res_model">benglish.session.transfer.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="binding_model_id" ref="model_benglish_academic_session" />
            <field name="binding_view_types">form</field>
        </record>

    </data>
</odoo>
