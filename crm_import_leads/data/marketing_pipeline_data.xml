<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data noupdate="0">
        <!-- 
            HU-CRM-03: Pipeline Marketing
            =============================
            Define el equipo/pipeline "Marketing" y sus etapas específicas.
            
            Etapas en orden:
            1. Nuevo
            2. Incontactable
            3. Pendiente / Volver a llamar
            4. Reprobado (No perfil)
            5. Aprobado → En evaluación
        -->

        <!-- EQUIPO CRM: Marketing -->
        <record id="crm_team_marketing" model="crm.team">
            <field name="name">Marketing</field>
            <field name="sequence">5</field>
            <field name="use_leads">True</field>
            <field name="use_opportunities">True</field>
            <field name="company_id" eval="False"/>  <!-- Multi-company: disponible para todas -->
        </record>

        <!-- ETAPA 1: Nuevo -->
        <record id="crm_stage_marketing_new" model="crm.stage">
            <field name="name">Nuevo</field>
            <field name="sequence">1</field>
            <field name="team_id" ref="crm_team_marketing"/>
            <field name="fold">False</field>
            <field name="is_won">False</field>
        </record>

        <!-- ETAPA 2: Incontactable -->
        <record id="crm_stage_marketing_unreachable" model="crm.stage">
            <field name="name">Incontactable</field>
            <field name="sequence">2</field>
            <field name="team_id" ref="crm_team_marketing"/>
            <field name="fold">False</field>
            <field name="is_won">False</field>
        </record>

        <!-- ETAPA 3: Pendiente / Volver a llamar -->
        <record id="crm_stage_marketing_pending" model="crm.stage">
            <field name="name">Pendiente / Volver a llamar</field>
            <field name="sequence">3</field>
            <field name="team_id" ref="crm_team_marketing"/>
            <field name="fold">False</field>
            <field name="is_won">False</field>
        </record>

        <!-- ETAPA 4: Reprobado (No perfil) -->
        <record id="crm_stage_marketing_rejected" model="crm.stage">
            <field name="name">Reprobado (No perfil)</field>
            <field name="sequence">4</field>
            <field name="team_id" ref="crm_team_marketing"/>
            <field name="fold">True</field>
            <field name="is_won">False</field>
        </record>

        <!-- ETAPA 5: Aprobado → En evaluación -->
        <record id="crm_stage_marketing_approved" model="crm.stage">
            <field name="name">Aprobado → En evaluación</field>
            <field name="sequence">5</field>
            <field name="team_id" ref="crm_team_marketing"/>
            <field name="fold">False</field>
            <field name="is_won">False</field>
        </record>

        <!-- 
            NOTA IMPORTANTE:
            ===============
            Este archivo crea el pipeline Marketing y sus etapas.
            
            Las validaciones de asignación de responsables están implementadas en:
            - models/crm_lead.py: método _check_marketing_commercial_assignment()
            
            Los roles comerciales se gestionan desde HR:
            - models/hr_employee.py: campos es_asesor_comercial, es_supervisor_comercial, es_director_comercial
            - models/res_users.py: campo computed is_commercial_user
            
            Para configurar:
            1. Ir a Recursos Humanos > Empleados
            2. Seleccionar empleado y marcar rol comercial correspondiente
            3. Los usuarios vinculados a esos empleados podrán ser asignados en pipeline Marketing
        -->

    </data>
</odoo>
